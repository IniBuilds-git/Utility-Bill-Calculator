<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<ScrollPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.utilitybill.controller.BillGeneratorController"
            fitToWidth="true"
            style="-fx-background-color: #f1f5f9; -fx-background: #f1f5f9;">

    <VBox spacing="25" style="-fx-background-color: #f1f5f9;">
        <padding>
            <Insets top="30" right="30" bottom="30" left="30"/>
        </padding>

        <!-- Page Header -->
        <VBox spacing="5">
            <Label text="Monthly Bill Calculator">
                <font>
                    <Font name="System Bold" size="28"/>
                </font>
            </Label>
            <Label text="Calculate electricity and gas bills based on meter readings" 
                   style="-fx-font-size: 14px; -fx-text-fill: #64748b;"/>
        </VBox>

        <!-- Error Label -->
        <Label fx:id="errorLabel" 
               visible="false" managed="false"
               style="-fx-background-color: #fef2f2; -fx-text-fill: #dc2626; -fx-padding: 12 15; -fx-background-radius: 8; -fx-font-size: 13px;"/>

        <!-- Main Content Grid -->
        <HBox spacing="20">
            <!-- Left Column: Electricity -->
            <VBox spacing="15" HBox.hgrow="ALWAYS"
                  style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 20;">
                
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Electricity" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
                </HBox>

                <Separator/>

                <!-- Standing Charge -->
                <VBox spacing="5">
                    <Label text="Standing Charge (p/day)" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                    <TextField fx:id="elecStandingChargeField" 
                               promptText="e.g., 22.63"
                               style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                </VBox>

                <!-- Unit Price -->
                <VBox spacing="5">
                    <Label text="Unit Price (p/kWh)" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                    <TextField fx:id="elecUnitPriceField" 
                               promptText="e.g., 19.349"
                               style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                </VBox>

                <Separator/>

                <!-- Day Meter Readings -->
                <Label text="Day Meter Readings" style="-fx-font-weight: bold; -fx-text-fill: #f59e0b;"/>
                
                <HBox spacing="10">
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="Opening" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                        <TextField fx:id="elecDayOpeningField" 
                                   promptText="Opening"
                                   style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                    </VBox>
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="Closing" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                        <TextField fx:id="elecDayClosingField" 
                                   promptText="Closing"
                                   style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                    </VBox>
                </HBox>

                <!-- Night Meter Readings -->
                <Label text="Night Meter Readings" style="-fx-font-weight: bold; -fx-text-fill: #6366f1;"/>
                
                <HBox spacing="10">
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="Opening" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                        <TextField fx:id="elecNightOpeningField" 
                                   promptText="Opening"
                                   style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                    </VBox>
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="Closing" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                        <TextField fx:id="elecNightClosingField" 
                                   promptText="Closing"
                                   style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                    </VBox>
                </HBox>
            </VBox>

            <!-- Right Column: Gas -->
            <VBox spacing="15" HBox.hgrow="ALWAYS"
                  style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 20;">
                
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Gas" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
                </HBox>

                <Separator/>

                <!-- Standing Charge -->
                <VBox spacing="5">
                    <Label text="Standing Charge (p/day)" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                    <TextField fx:id="gasStandingChargeField" 
                               promptText="e.g., 24.87"
                               style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                </VBox>

                <!-- Unit Price -->
                <VBox spacing="5">
                    <Label text="Unit Price (p/kWh)" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                    <TextField fx:id="gasUnitPriceField" 
                               promptText="e.g., 3.987"
                               style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                </VBox>

                <Separator/>

                <!-- Gas Meter Readings -->
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="Gas Meter Readings" style="-fx-font-weight: bold; -fx-text-fill: #ef4444;"/>
                    <CheckBox fx:id="imperialMeterCheckbox" 
                              text="Imperial (ft³)" 
                              selected="true"
                              style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                </HBox>
                
                <HBox spacing="10">
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="Opening" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                        <TextField fx:id="gasOpeningField" 
                                   promptText="Opening"
                                   style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                    </VBox>
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="Closing" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                        <TextField fx:id="gasClosingField" 
                                   promptText="Closing"
                                   style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                    </VBox>
                </HBox>

                <Separator/>

                <!-- Billing Period -->
                <VBox spacing="5">
                    <Label text="Billing Period (days)" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                    <TextField fx:id="billingDaysField" 
                               promptText="e.g., 33"
                               style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                </VBox>

                <!-- VAT Rate -->
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="VAT Rate (%)" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                        <TextField fx:id="vatRateField" 
                                   promptText="e.g., 5"
                                   style="-fx-background-color: #f8fafc; -fx-border-color: #e2e8f0; -fx-border-radius: 6; -fx-background-radius: 6;"/>
                    </VBox>
                </HBox>

                <!-- VAT Inclusive Checkbox -->
                <CheckBox fx:id="vatInclusiveCheckbox" 
                          text="Prices already include VAT"
                          selected="false"
                          style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
            </VBox>
        </HBox>

        <!-- Action Buttons -->
        <HBox spacing="15" alignment="CENTER">
            <Button text="Clear All" 
                    onAction="#handleClear"
                    prefHeight="45" prefWidth="150"
                    style="-fx-background-color: #e2e8f0; -fx-text-fill: #475569; -fx-font-size: 15px; -fx-font-weight: bold; -fx-background-radius: 8; -fx-cursor: hand;"/>
            <Button text="Calculate My Bill" 
                    onAction="#handleCalculate"
                    prefHeight="45" prefWidth="200"
                    style="-fx-background-color: #0d9488; -fx-text-fill: white; -fx-font-size: 15px; -fx-font-weight: bold; -fx-background-radius: 8; -fx-cursor: hand;"/>
        </HBox>

        <!-- Results Panel -->
        <VBox fx:id="resultsPanel" spacing="20" visible="false" managed="false"
              style="-fx-background-color: linear-gradient(to right, #0d9488, #14b8a6); -fx-background-radius: 12; -fx-padding: 25;">
            
            <Label text="MONTHLY BILL" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px; -fx-font-weight: bold;"/>
            
            <Label fx:id="billingPeriodLabel" text="FOR 33 DAYS" 
                   style="-fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;"/>

            <HBox spacing="30" alignment="CENTER">
                <!-- Electricity Result -->
                <VBox spacing="8" alignment="CENTER" 
                      style="-fx-background-color: rgba(255,255,255,0.15); -fx-background-radius: 10; -fx-padding: 20 40;">
                    <Label text="Electricity Bill" style="-fx-text-fill: rgba(255,255,255,0.9); -fx-font-size: 14px;"/>
                    <Label fx:id="elecBillLabel" text="£0.00" 
                           style="-fx-text-fill: white; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                </VBox>

                <!-- Gas Result -->
                <VBox spacing="8" alignment="CENTER"
                      style="-fx-background-color: rgba(255,255,255,0.15); -fx-background-radius: 10; -fx-padding: 20 40;">
                    <Label text="Gas Bill" style="-fx-text-fill: rgba(255,255,255,0.9); -fx-font-size: 14px;"/>
                    <Label fx:id="gasBillLabel" text="£0.00" 
                           style="-fx-text-fill: white; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                </VBox>

                <!-- Total -->
                <VBox spacing="8" alignment="CENTER"
                      style="-fx-background-color: rgba(255,255,255,0.25); -fx-background-radius: 10; -fx-padding: 20 40;">
                    <Label text="Total" style="-fx-text-fill: rgba(255,255,255,0.9); -fx-font-size: 14px;"/>
                    <Label fx:id="totalBillLabel" text="£0.00" 
                           style="-fx-text-fill: white; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                </VBox>
            </HBox>

            <!-- Detailed Breakdown -->
            <HBox spacing="20">
                <!-- Electricity Details -->
                <VBox spacing="8" HBox.hgrow="ALWAYS"
                      style="-fx-background-color: rgba(255,255,255,0.1); -fx-background-radius: 8; -fx-padding: 15;">
                    <Label text="Electricity Breakdown" style="-fx-text-fill: white; -fx-font-weight: bold;"/>
                    <HBox spacing="10">
                        <Label text="Day units:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="elecDayUnitsLabel" text="0 kWh" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <HBox spacing="10">
                        <Label text="Night units:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="elecNightUnitsLabel" text="0 kWh" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <HBox spacing="10">
                        <Label text="Total units:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="elecTotalUnitsLabel" text="0 kWh" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <Separator style="-fx-background-color: rgba(255,255,255,0.2);"/>
                    <HBox spacing="10">
                        <Label text="Unit cost:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="elecUnitCostLabel" text="£0.00" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <HBox spacing="10">
                        <Label text="Standing charge:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="elecStandingCostLabel" text="£0.00" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <HBox spacing="10">
                        <Label text="Subtotal:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="elecSubtotalLabel" text="£0.00" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <HBox spacing="10">
                        <Label text="VAT:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="elecVatLabel" text="£0.00" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                </VBox>

                <!-- Gas Details -->
                <VBox spacing="8" HBox.hgrow="ALWAYS"
                      style="-fx-background-color: rgba(255,255,255,0.1); -fx-background-radius: 8; -fx-padding: 15;">
                    <Label text="Gas Breakdown" style="-fx-text-fill: white; -fx-font-weight: bold;"/>
                    <HBox spacing="10">
                        <Label text="Volume:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="gasUnitsLabel" text="0 m³" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <HBox spacing="10">
                        <Label text="Converted:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="gasKwhLabel" text="0 kWh" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <Separator style="-fx-background-color: rgba(255,255,255,0.2);"/>
                    <HBox spacing="10">
                        <Label text="Unit cost:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="gasUnitCostLabel" text="£0.00" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <HBox spacing="10">
                        <Label text="Standing charge:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="gasStandingCostLabel" text="£0.00" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <HBox spacing="10">
                        <Label text="Subtotal:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="gasSubtotalLabel" text="£0.00" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                    <HBox spacing="10">
                        <Label text="VAT:" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                        <Label fx:id="gasVatLabel" text="£0.00" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
                    </HBox>
                </VBox>
            </HBox>
        </VBox>

    </VBox>
</ScrollPane>

